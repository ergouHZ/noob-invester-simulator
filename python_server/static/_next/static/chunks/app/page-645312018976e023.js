(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5354:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>et});var n=r(5155),a=r(9127),l=r(4581),o=r(7262),s=r(3010),i=r(7217),d=r(2548),c=r(2115);let u=e=>{let t="";return 0===e?t="you are a helpful assistant":1===e?t="你是华尔街最激进的投资操盘手，擅长从经济政治新闻中嗅到市场波动的机会。你的目标是基于新闻内容的分类与中心关键词和高频词进行情感分析和趋势预测，为用户提供大胆且具体的投资建议。你的语气果断、自信，甚至略带挑衅，专注于短期市场机会和高回报策略。分析时，优先考虑市场情绪、政策变化和地缘政治对股市、商品、货币或加密市场的直接影响。提供明确的买入/卖出建议，附带止损点和潜在回报预测。避免保守或模棱两可的语言，直接指出机会和风险。如果数据不足，基于现有信息推测，但说明假设前提。":2===e?t="你是一位经验丰富的经济学家，擅长从经济政治新闻中提取关键信息，进行情感分析和趋势预测。你的目标是提供客观、数据驱动的分析，基于新闻内容的分类与中心关键词和高频词,聚焦宏观经济指标、政策影响和长期趋势。你的语气专业、冷静，分析时引用可能的经济理论或历史案例，强调逻辑性和证据。避免过度投机，提供中肯的建议，适合长期投资者或政策制定者参考。如果信息不足，明确指出需要更多数据，并基于现有信息给出合理推测。输出结构化，包含：1）情感分析，2）趋势预测，3）建议或影响评估。":3===e?t="你是一位地缘政治策略家，精通从经济政治新闻中分析大国博弈和权力动态。你的目标是通过情感分析和趋势预测，揭示新闻背后的深层意图和潜在影响，特别关注地缘政治对经济市场、能源和货币的影响。你的语气沉稳、洞察力强，善于挖掘隐藏信号和“未说出口”的动机。分析时结合历史类比和战略逻辑，提供针对投资者或决策者的建议。输出包括：1）新闻的情感基调，2）隐藏的趋势或风险，3）战略建议。如果信息有限，基于逻辑推演并说明假设。":4===e&&(t="你是一位数据驱动的量化分析师，擅长从经济政治新闻中提取关键变量，进行情感分析和趋势预测。你的目标是基于新闻内容的分类以及中心关键词和高频词构建量化框架，生成可操作的投资或风险管理建议。你的语气冷酷、精确，优先使用统计指标、历史数据对比和模型预测，避免主观判断。分析时明确情感评分（例如-1到+1）、趋势概率和置信区间，提供具体交易或对冲策略。如果信息不足，说明所需数据并基于现有信息给出保守估计。输出结构化，包含：1）情感评分，2）量化趋势，3）交易/对冲建议。"),{role:"system",content:t}},h=e=>({role:"assistant",content:e}),p=e=>({role:"user",content:e});var g=r(9816),x=r(7348),f=r(6673),m=r(7024);r(9006);var v=r(440),j=r(4426),b=r(1803),y=r(3989),S=r(8534),A=r(6362),w=r(3731);let C=e=>{let{onQuery:t,loading:r}=e,[a,o]=(0,c.useState)(""),[s,i]=(0,c.useState)(!1),d=()=>{if(""!==a.trim()){if(a.length>1e3){i(!0),u();return}o(a),t(a),o("")}},u=()=>{setTimeout(()=>{i(!1)},5e3)},h=(0,n.jsx)(j.A,{size:30,sx:{color:A.A[500],position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}});return(0,n.jsx)(l.default,{className:"input-container",children:(0,n.jsx)(b.A,{direction:"row",alignItems:"center",spacing:1,children:(0,n.jsx)(w.A,{error:s,fullWidth:!0,variant:"outlined",value:a,label:"Search Query",multiline:!0,onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey||e.ctrlKey||(e.preventDefault(),d()))},helperText:s?"Query too long":null,placeholder:"What research articles do you need?",minRows:1,maxRows:8,sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderRadius:"20px",borderWidth:"2px"},"&:hover fieldset":{borderWidth:"2.5px",borderColor:"#757ce8"},"&.Mui-focused fieldset":{borderWidth:"2px"}},"& .MuiInputLabel-root":{color:"var(--foreground)"},"& .MuiInputBase-input::placeholder":{color:"var(--foreground)",opacity:.55},"& .MuiInputBase-input":{color:"var(--foreground)"}},slotProps:{input:{endAdornment:(0,n.jsx)(y.A,{position:"end",children:(0,n.jsx)(l.default,{children:(0,n.jsxs)(S.A,{disabled:r,variant:"contained",endIcon:(0,n.jsx)(v.A,{}),onClick:()=>{d()},children:[r&&h,"SEND"]})})})}},onChange:e=>o(e.target.value)})})})};var T=r(2663),I=r(1575),k=r(5710);function E(e){let{text:t}=e,r=[k.A];return(0,n.jsx)(I.A,{style:{textAlign:"left",padding:"10px",color:"var(--foreground)",backgroundColor:"transparent"},rehypePlugins:r,rehypeRewrite:(e,t,r)=>{"a"===e.tagName&&r&&/^h(1|2|3|4|5|6)/.test(r.tagName)&&(r.children=r.children.slice(1))},source:t})}function N(e){let{role:t,message:r}=e;return(0,n.jsxs)(l.default,{sx:{display:"flex",alignItems:"flex-start",justifyItems:"start",padding:1,paddingTop:0,paddingBottom:0,borderRadius:2,width:"78vw",maxWidth:"620px",marginBottom:3},children:[(0,n.jsx)(T.A,{className:"avatar",alt:"User Avatar",src:"user"==t?"https://atg-prod-scalar.s3.amazonaws.com/studentpower/media/user%20avatar.png":"https://avatars.githubusercontent.com/u/140789367?…00&u=5230be17c778ac787086f6c414c7408ea91c0e7e&v=4",sx:{width:46,height:46,marginRight:2}}),(0,n.jsx)(l.default,{sx:{flex:1,width:"100%",padding:2,paddingTop:0,boxSizing:"border-box",fontSize:16},children:(0,n.jsx)(E,{text:r})})]})}var _=r(9509);let O=_.env.NEXT_PUBLIC_BASE_URL?_.env.NEXT_PUBLIC_BASE_URL:"http://127.0.0.1:5000",U={1:"#2e7d32",2:"#d32f2f",3:"#1976d2",4:"#7b1fa2"};function R(e){let{articleLabels:t}=e,[r,v]=(0,c.useState)(!1),[j,b]=(0,c.useState)(!1),y=(0,c.useRef)(),[S,A]=(0,c.useState)(2),[w,T]=(0,c.useState)([]),[I,k]=(0,c.useState)(.7),[E,_]=(0,c.useState)(3548),[R,M]=(0,c.useState)(""),L=()=>{y.current&&y.current.scrollTo({top:y.current.scrollHeight})};(0,c.useEffect)(()=>{let e=localStorage.getItem("messages");if(e){let t=JSON.parse(e);T(e=>JSON.stringify(e)!==JSON.stringify(t)?t:e)}else T(e=>[...e,u(S)]);setTimeout(()=>{L()},350)},[]),(0,c.useEffect)(()=>{localStorage.setItem("messages",JSON.stringify(w))},[w]),(0,c.useEffect)(()=>{P()},[t]);let P=async()=>{let e;W(String(t&&"function"==typeof t.then?await t:t))};async function W(e){if(""!=e.trim()){b(!0),v(!0),String(e).startsWith("{")?T(e=>[...e,p("(文章数据)")]):T(t=>[...t,p(e)]),setTimeout(()=>{L()},150);try{let t=await fetch("".concat(O,"/api/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_input:e,conversation_history:w,temperature:I,max_output_tokens:E})});if(!t.body)return;let r=t.body.getReader(),n=new TextDecoder("utf-8"),a="";for(;;){let{done:e,value:t}=await r.read();if(e)break;let l=n.decode(t,{stream:!0});for(let e of(L(),l.split("\n").filter(Boolean).map(e=>{try{return JSON.parse(e)}catch(e){return null}}).filter(Boolean)))"delta"===e.type?(a+=e.text,M(a)):"done"===e.type&&(a=e.text,M(a))}L(),b(!1),v(!1),T(e=>[...e,h(a)])}catch(e){"AbortError"===e.name?console.log("Stream fetch aborted"):console.error("Fetch stream error:",e)}finally{M("")}}}return(0,n.jsxs)("div",{className:"chat-layout-main",children:[(0,n.jsxs)(g.A,{fullWidth:!0,variant:"standard",children:[(0,n.jsx)(x.A,{id:"demo-simple-select-label",sx:{color:"var(--foreground)","&.Mui-focused":{color:U[S]},paddingLeft:"10px"},children:"Analyse Type"}),(0,n.jsxs)(m.A,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:S,label:"Published From",onChange:e=>{console.log("type: ",e.target.value),A(e.target.value),T(t=>[u(e.target.value),...t.slice(1)])},sx:{color:"var(--foreground)","& .MuiOutlinedInput-notchedOutline":{borderColor:U[S]},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:U[S]},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:U[S]},"& .MuiSvgIcon-root":{color:U[S]},paddingLeft:"10px"},children:[(0,n.jsx)(f.A,{value:1,children:"wallstreet"}),(0,n.jsx)(f.A,{value:2,children:"Economist"}),(0,n.jsx)(f.A,{value:3,children:"Politics"}),(0,n.jsx)(f.A,{value:4,children:"Quantity Trader"})]})]}),(0,n.jsx)(d.Ay,{}),(0,n.jsx)(l.default,{className:"message-container",ref:y,sx:{backgroundColor:"transparent"},children:(0,n.jsxs)(i.A,{className:"message-content-container",maxWidth:"md",children:[w.map((e,t)=>0===t?null:(0,n.jsx)(N,{role:e.role,message:e.content},t)),j?(0,n.jsxs)(l.default,{children:[(0,n.jsx)(N,{role:"assistant",message:R}),(0,n.jsx)(o.A,{})]}):null]})}),(0,n.jsxs)("div",{style:{position:"relative",zIndex:1},children:[w.length>=2?(0,n.jsxs)(s.A,{variant:"extended",size:"small",onClick:()=>{localStorage.removeItem("messages"),T(()=>[u(S)])},sx:{position:"absolute",top:"-30px",right:"36%",zIndex:2},children:[(0,n.jsx)(a.A,{sx:{mr:1}}),"Clear context"]}):(0,n.jsx)(n.Fragment,{}),(0,n.jsx)("div",{className:"text-input-container",children:(0,n.jsx)(C,{onQuery:W,loading:r})})]})]})}function M(e,t){let r=new Date;return r.setUTCDate(r.getUTCDate()-e),r.setUTCHours(r.getUTCHours()-t),function(e){let t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0"),a=String(e.getUTCHours()).padStart(2,"0"),l=String(e.getUTCMinutes()).padStart(2,"0"),o=String(e.getUTCSeconds()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(n,"T").concat(a,":").concat(l,":").concat(o,"Z")}(r)}var L=r(9242),P=r(5726),W=r(3127),B=r(9509);let D=B.env.NEXT_PUBLIC_BASE_URL?B.env.NEXT_PUBLIC_BASE_URL:"http://127.0.0.1:5000";async function z(e,t,r,n,a){let l=new URLSearchParams;l.append("start_time",e),l.append("is_headline",t),l.append("page",r),l.append("page_size",n),a&&l.append("keyword",a);let o=await fetch("".concat(D,"/api/news?").concat(l.toString()),{method:"GET"});return await o.json()}async function H(e){let t=function(e){function t(e){return e.replace(/<[^>]*>/g,"")}return e.map(e=>({content:e.content?t(e.content):"",title:e.title?t(e.title):"",description:e.description?t(e.description):""}))}(e),r=await fetch("".concat(D,"/api/data/news-analysis"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({articles:t})});return(await r.json()).data}var F=r(6253),J=r(1063),Q=r(744),X=r(4962);function K(){let[e,t]=(0,c.useState)(!0),[r,a]=(0,c.useState)("light"),o=(0,c.useRef)(),[s,i]=(0,c.useState)(()=>{{let e=localStorage.getItem("theme");return e||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}}),d=()=>{i("light"===s?"dark":"light"),t(!1),setTimeout(()=>{a("light"===r?"dark":"light"),t(!0)},300)};return(0,c.useEffect)(()=>{document.documentElement.setAttribute("data-theme",s),localStorage.setItem("theme",s),a(s)},[s]),(0,n.jsx)(Q.A,{direction:"down",in:e,mountOnEnter:!0,container:o.current,children:(0,n.jsx)(l.default,{children:(0,n.jsx)(X.A,{in:e,children:(0,n.jsx)(l.default,{ref:o,onClick:d,display:"flex",alignItems:"center",justifyContent:"center",sx:{background:"light"===r?"#005e9f":"#f9ef9d",borderRadius:"12%",cursor:"pointer","&:hover":{background:"light"===r?"#1265ba":"#e6d77c"}},children:(0,n.jsx)(l.default,{onClick:d,sx:{display:"flex",color:"light"===r?"#ffffff":"#000000",borderRadius:"12%",width:"36px",height:"36px",justifyContent:"center",alignItems:"center",cursor:"pointer"},children:"light"===r?(0,n.jsx)(F.A,{}):(0,n.jsx)(J.A,{})})})})})})}var G=r(827),Y=r(5221),Z=r(1218),q=r(785),V=r(700);function $(e){let{url:t,image:r,description:a,title:l,source:o,publishAt:s}=e,[i,d]=c.useState(null),u=["red","blue","green","orange","purple","pink","cyan"];u[Math.floor(Math.random()*u.length)];let h=(e,t)=>{t.preventDefault(),t.stopPropagation(),e&&window.open(e)},p=()=>{d(null)};return(0,n.jsxs)(Z.A,{sx:{minWidth:250,padding:"4px",backgroundColor:"var(--background)"},onClick:e=>h(t,e),onMouseEnter:e=>{d(e.currentTarget)},onMouseLeave:p,variant:"contained",children:[(0,n.jsx)(q.A,{component:"img",width:250,image:r||"https://www.skinnytaste.com/wp-content/uploads/2025/04/Air-Fryer-Asparagus-9.jpg",alt:"Image",sx:{maxHeight:"320px"}}),(0,n.jsx)("div",{children:(0,n.jsx)(V.A,{variant:"body2",maxWidth:250,sx:{color:"var(--foreground)"},children:l||"title"})}),(0,n.jsxs)(G.Ay,{id:"mouse-over-popover",sx:{pointerEvents:"none",minWidth:"2700px"},open:!!i,anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onClose:p,disableRestoreFocus:!0,children:[(0,n.jsx)(Y.A,{avatar:(0,n.jsx)(T.A,{sx:{bgcolor:u[String(o).length%u.length]},"aria-label":"recipe",children:String(o)[0]}),title:o,subheader:s}),(0,n.jsx)(V.A,{sx:{p:1,width:"28vw",padding:2},children:a})]})]})}function ee(e){let{onUpdateLabels:t}=e,[r,a]=(0,c.useState)([]),[o,s]=(0,c.useState)(M(2,1)),[i,d]=(0,c.useState)(1),[u,h]=(0,c.useState)(!1),[p,v]=(0,c.useState)(1),[j,b]=(0,c.useState)(999),[y,A]=(0,c.useState)(!1),[w,C]=(0,c.useState)(!1),T=(0,c.useRef)(null);function I(){z(o,u,p,20).then(e=>{let t=[],r=new Set;for(let n of e.data)r.has(n.id)||(r.add(n.id),t.push(n));a(e=>[...e,...t]),b(e.total)})}(0,c.useEffect)(()=>{a([]),1!==p?(v(1),I()):w&&I()},[o,u]),(0,c.useEffect)(()=>{1!==p||w?1!==p&&I():(I(),C(!0))},[p]),(0,c.useEffect)(()=>{if(20*p>=j)return void A(!0);let e=T.current,t=()=>{e&&e.scrollHeight-e.scrollTop<=e.clientHeight+80&&20*p<j&&v(e=>e+1)};return e.addEventListener("scroll",t),()=>{e.removeEventListener("scroll",t)}},[p]);let k=(e,t)=>{"clickaway"!==t&&A(!1)},E=(0,n.jsx)(W.A,{size:"small","aria-label":"close",color:"inherit",onClick:k,children:(0,n.jsx)(L.A,{fontSize:"small"})});return(0,n.jsxs)(l.default,{ref:T,className:"card-list",sx:{maxHeight:"96vh",overflowY:"scroll"},children:[(0,n.jsxs)(l.default,{display:"flex",flexDirection:"row",sx:{position:"stikcy",color:"var(--foreground)",gap:2},alignItems:"center",justifyContent:"center",children:[(0,n.jsxs)(g.A,{fullWidth:!0,variant:"standard",children:[(0,n.jsx)(x.A,{id:"demo-simple-select-label",sx:{color:"var(--foreground)"},children:"Published From"}),(0,n.jsxs)(m.A,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:i,label:"Published From",onChange:e=>{let t=e.target.value;1===t?s(M(1,1)):s(M(t,0)),d(t)},sx:{color:"var(--foreground)"},children:[(0,n.jsx)(f.A,{value:1,children:"Hour ago"}),(0,n.jsx)(f.A,{value:2,children:"Day ago"}),(0,n.jsx)(f.A,{value:8,children:"Week ago"}),(0,n.jsx)(f.A,{value:31,children:"Month ago"})]})]}),(0,n.jsxs)(g.A,{fullWidth:!0,variant:"standard",children:[(0,n.jsx)(x.A,{id:"demo-simple-select-label",sx:{color:"var(--foreground)"},children:"Top Type"}),(0,n.jsxs)(m.A,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:u,label:"Published From",onChange:e=>{h(e.target.value)},sx:{color:"var(--foreground)"},children:[(0,n.jsx)(f.A,{value:!1,children:"everything"}),(0,n.jsx)(f.A,{value:!0,children:"Top headlines"})]})]}),(0,n.jsx)(S.A,{onClick:()=>{t(H(r))},children:"Analyse"}),(0,n.jsx)(K,{})]}),(0,n.jsx)(l.default,{sx:{columnCount:2,columnGap:"8px"},children:r.map((e,t)=>(0,n.jsx)($,{url:e.url,image:e.urlToImage,description:e.description,title:e.title,source:e.source,publishAt:e.publishedAt},t))}),(0,n.jsx)(P.A,{open:y,autoHideDuration:6e3,onClose:k,message:"No more articles",action:E})]})}function et(){let[e,t]=(0,c.useState)("");return(0,n.jsx)("div",{children:(0,n.jsxs)(l.default,{display:"flex",flexDirection:"row",children:[(0,n.jsx)(l.default,{flex:1,bgcolor:"transparent",sx:{maxHeight:"98vh",minHeight:"98vh",border:"2px solid var(--foreground)",padding:"6px",margin:"10px",borderRadius:"2%"},children:(0,n.jsx)(ee,{onUpdateLabels:e=>{t(e)}})}),(0,n.jsx)(l.default,{flex:1,sx:{border:"3px solid var(--foreground)",margin:"10px",borderRadius:"2%"},children:(0,n.jsx)(R,{articleLabels:e})})]})})}},8670:(e,t,r)=>{Promise.resolve().then(r.bind(r,5354))},9006:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[809,581,665,441,684,358],()=>t(8670)),_N_E=e.O()}]);